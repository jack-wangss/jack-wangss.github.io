---
layout: post
title: "FOCG5: 5.表面着色"
subtitle: "FOCG5: 5 Surface Shading"
background: '/img/posts/01.jpg'
---

用与计算着色的方程叫做着色模型（shading model），针对不同的应用，有很多不同的着色模型。着色模型相对独立，一些模型既可以用在光线追踪系统，也能用在着色系统中。本章主要介绍一个基于点光源的简单着色模型。


## 5.1 点状光源

真实世界中，表面的光来自各个方向。但是对于模型的照明，最简单的场景是光源来自一个方向。这个比较理想化，但也提供了一个实用的小光源模型。可能光源确实很小，也可能是距离太远。点状光源有两个特性：点光源足够小，可以当作一个点，距离表面的远近会影响照明效果；定向光源同样足够小，同时距离物体很远，且距离不会影响照明效果，所以不需要关注定向光源的位置，只需要关注其方向。这两个类型的光源就像是手电筒和太阳。

### 5.1.1 点光源照明

点光源由其位置和强度定义。点光源可以是各向同性的`isotropic`，意味着所有方向的能量相等，也有一些系统提供类似射灯的光源，只会向固定方向发光。

对于各向同性的点光源，很容易计算表面接受的光量。例如我们有这样一个发射1瓦特能量的光源，我们把它放到一个半径1m的空心球中，所有在球内表面的能量均匀的分布在面积为$4\pi m^2$的表面，所以每平方米的能量密度是 $1/(4\pi)$。这个密度叫辐照度（irradiance）,是一个用来描述光照射到表面数量的量，我们用它来计算光的反射。

一般情况下，光源的能量为P，接受的球半径为r，则irradiance E为：

$$ E=\frac{P}{4\pi}\frac{1}{r^2}=\frac{I}{r^2}$$

$I=P/ 4\pi$ 代表光源的强度，它是光源自身的属性，与照明的表面形状无关。$r^{-2}$一般叫做平方反比，描述irradiance与光源到表面距离r的关系。

计算irradiance还需要考虑的问题是入射角（angle of incidence），面法向和光线方向的夹角。如图5.2，面法向与光线方向一致时，表面接收了全部的光线；将面倾斜60°时，只接受到了一半的光线。转动$\theta$ 度所接收的能量与 $\cos \theta $成正比。因为面积没有变化，所有irradiance（每单位面积的辐射能量）也和同样的因子成正比。这就是`Lamber's cosine law`，因为Johann Heinrich Lambert在他1760年的书 `Photometria`提出。

<div style="text-align: center">
<img src="/img/posts/5 Surface Shading/1.png"/>
</div>

结合上述内容，我们得到以下公式：

$$ E=I\frac{\cos \theta}{r^2}$$